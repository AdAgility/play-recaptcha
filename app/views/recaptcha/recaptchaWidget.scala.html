@****************************************************************************************
 * Low-level API: Renders a Google Recaptcha Widget, independent of the Play Forms API.
 *
 * @param error         The error code (if any)
 * @param tabindex      The tabindex of the field (if any)
 * @param request       (Implicit) The current request
 * @param lang          (Implicit) The current language
 ****************************************************************************************@
@(error: Option[String] = None, tabindex: Option[Int] = None)(implicit request: Request[AnyContent], lang: Lang)

@import com.nappin.play.recaptcha.{RecaptchaConfiguration, WidgetHelper}
@import play.api.Play.current

@errorCode = @{ error.map("&error=" + _).getOrElse("") }
@publicKey = @{ current.configuration.getString(RecaptchaConfiguration.publicKey).map("?k=" + _).getOrElse("") }

<script type="text/javascript">
@Html(WidgetHelper.getRecaptchaOptions(tabindex))
</script>

<script type="text/javascript"
  src="http://www.google.com/recaptcha/api/challenge@Html(publicKey)@Html(errorCode)">
</script>
<noscript>
   <iframe src="http://www.google.com/recaptcha/api/noscript@Html(publicKey)@Html(errorCode)" 
       height="300" width="500" frameborder="0"></iframe><br>
   <textarea name="recaptcha_challenge_field" rows="3" cols="40">
   </textarea>
   <input type="hidden" name="recaptcha_response_field" value="manual_challenge">
</noscript>