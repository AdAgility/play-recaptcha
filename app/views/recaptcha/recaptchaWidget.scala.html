@****************************************************************************************
 * Low-level API: Renders a Google Recaptcha Widget, independent of the Play Forms API.
 *
 * @param error         The error code (if any)
 * @param tabindex      The tabindex of the field (if any)
 ****************************************************************************************@
@(error: Option[String] = None, tabindex: Option[Int] = None)

@import com.nappin.play.recaptcha.RecaptchaConfiguration
@import play.api.Play.current

@errorCode = @{ error.map("&error=" + _).getOrElse("") }
@publicKey = @{ current.configuration.getString(RecaptchaConfiguration.publicKey).map("?k=" + _).getOrElse("") }
@themeName = @{ current.configuration.getString(RecaptchaConfiguration.theme) }
@needOptionsBlock = @{ themeName.isDefined || tabindex.isDefined }

@if(needOptionsBlock) { 
<script type="text/javascript">
var RecaptchaOptions = {
    @if(themeName.isDefined) { theme : '@themeName.get'@if(tabindex.isDefined) {,} }
    @if(tabindex.isDefined) { tabindex : @tabindex.get }
 };
</script>
}

<script type="text/javascript"
  src="http://www.google.com/recaptcha/api/challenge@Html(publicKey)@Html(errorCode)">
</script>
<noscript>
   <iframe src="http://www.google.com/recaptcha/api/noscript@Html(publicKey)@Html(errorCode)" 
       height="300" width="500" frameborder="0"></iframe><br>
   <textarea name="recaptcha_challenge_field" rows="3" cols="40">
   </textarea>
   <input type="hidden" name="recaptcha_response_field" value="manual_challenge">
</noscript>